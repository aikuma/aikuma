package au.edu.melbuni.boldapp;

import android.graphics.Color;
import android.view.View;
import android.view.animation.AlphaAnimation;
import android.view.animation.Animation;
import android.view.animation.AnimationSet;
import android.widget.Button;
import android.widget.LinearLayout;

public class Segment {
	
	TimeLine timeLine = null;
	String identifier = null;
	Button view = null;
	
	public Segment(final TimeLine timeLine, int id) {
		this.timeLine   = timeLine;
		this.identifier = timeLine.identifier + new Integer(id).toString();
		this.view       = new Button(timeLine.getContext());
		
		this.view.setWidth(100);
		
		this.view.setOnClickListener(new View.OnClickListener() {
			@Override
			public void onClick(View view) {
				timeLine.setSelectedForRecording(Segment.this);
				timeLine.setSelectedForPlaying(Segment.this);
			}
		});
		this.view.setOnLongClickListener(new View.OnLongClickListener() {
			// TODO Ask if it should be removed.
			//
			@Override
			public boolean onLongClick(View v) {
				timeLine.remove(Segment.this);
				return false;
			}
		});
	}

	public void addTo(LinearLayout layout) {
		layout.addView(view);
	}
	public void removeFrom(LinearLayout layout) {
		layout.removeView(view);
	}
	
	public void startPlaying(Recorder recorder) {
		AnimationSet animations = new AnimationSet(true);
		Animation fadeOut = new AlphaAnimation(1.0f, 0.0f);
		fadeOut.setDuration(500);
		animations.addAnimation(fadeOut);
		Animation fadeIn = new AlphaAnimation(0.0f, 1.0f);
		fadeIn.setDuration(500);
		animations.addAnimation(fadeIn);
		animations.setRepeatCount(AnimationSet.INFINITE);
		view.startAnimation(animations);
		
		recorder.startPlaying(identifier);
	}
	public void stopPlaying(Recorder recorder) {
		recorder.stopPlaying();
	}
	public void startRecording(Recorder recorder) {
		recorder.startRecording(identifier);
	}

	public void select() {
		view.setBackgroundColor(Color.LTGRAY);
	}
	public void unselect() {
		view.setBackgroundColor(Color.GRAY);
	}
	
}
